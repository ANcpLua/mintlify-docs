name: CI

on:
  pull_request:
    branches: [main]
  push:
    branches: [main]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v6

      - name: Setup Node.js
        uses: actions/setup-node@v6
        with:
          node-version: '22'

      - name: Check broken links
        run: npx mintlify@latest broken-links

      - name: Validate docs.json
        run: |
          node -e "
            const fs = require('fs');
            const config = JSON.parse(fs.readFileSync('docs.json', 'utf8'));
            if (!config.name) throw new Error('Missing name in docs.json');
            if (!config.navigation) throw new Error('Missing navigation in docs.json');
            console.log('docs.json is valid');
          "
