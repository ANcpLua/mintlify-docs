---
title: 'Roslyn Utilities'
sidebarTitle: 'Overview'
description: 'Utilities for source generators and analyzers.'
icon: 'code'
---

ANcpLua.Roslyn.Utilities provides utilities for building Roslyn analyzers and source generators.

## Install

```shell
dotnet add package ANcpLua.Roslyn.Utilities
dotnet add package ANcpLua.Roslyn.Utilities.Testing
```

<Warning>
  **Layer 0 Package**: This package cannot depend on ANcpLua.NET.Sdk (circular
  dependency). Uses `Microsoft.NET.Sdk` and
  [PolySharp](https://github.com/Sergio0694/PolySharp) for polyfills.
</Warning>

## Packages

| Package                          | Target         | Description       |
| -------------------------------- | -------------- | ----------------- |
| ANcpLua.Roslyn.Utilities         | netstandard2.0 | Core library      |
| ANcpLua.Roslyn.Utilities.Testing | net10.0        | Generator testing |

## Features

| Category          | APIs                                          | Docs                                         |
| ----------------- | --------------------------------------------- | -------------------------------------------- |
| Flow Control      | `DiagnosticFlow<T>`, `ReportAndContinue()`    | [DiagnosticFlow](/utilities/diagnostic-flow) |
| Pattern Matching  | `SymbolPattern.*`, `Match.*`, `Invoke.*`      | [Patterns](/utilities/patterns)              |
| Validation        | `SemanticGuard<T>`, `MustBeAsync()`           | [SemanticGuard](/utilities/semantic-guard)   |
| Domain Contexts   | `AwaitableContext`, `AspNetContext`           | [Contexts](/utilities/contexts)              |
| Operations        | `OperationExtensions`, `InvocationExtensions` | [Operations](/utilities/operations)          |
| Code Generation   | `IndentedStringBuilder`                       | [Codegen](/utilities/codegen)                |
| Pipeline          | `GroupBy()`, `Batch()`, `Distinct()`          | [Pipeline](/utilities/pipeline)              |
| Symbol Extensions | `IsEqualTo()`, `HasAttribute()`               | [Symbols](/utilities/symbols)                |
| Testing           | `Test<TGenerator>.Run()`, caching validation  | [Testing](/utilities/testing)                |

## Quick Example

```csharp
// DiagnosticFlow - never lose diagnostics
symbol.ToFlow(nullDiag)
    .Then(ValidateMethod)
    .Where(m => m.IsAsync, asyncRequired)
    .WarnIf(m => m.IsObsolete, obsoleteWarn)
    .Then(GenerateCode)
    .ReportAndContinue(context);

// Pattern matching - replace 50-line if-statements
var asyncTask = SymbolPattern.Method()
    .Async()
    .ReturnsTask()
    .WithCancellationToken()
    .Build();

if (asyncTask.Matches(method)) { ... }
```
